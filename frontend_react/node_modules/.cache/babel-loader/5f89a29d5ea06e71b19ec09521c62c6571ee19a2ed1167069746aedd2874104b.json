{"ast":null,"code":"var _jsxFileName = \"/Users/wangchenhui/Desktop/final_project_belay/react/src/components/ChannelList.jsx\",\n  _s = $RefreshSig$();\n// ChannelList.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../styles/channelList.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ChannelList() {\n  _s();\n  const [channels, setChannels] = useState([]);\n  const [currentChannelId, setCurrentChannelId] = useState(null);\n  let navigate = useNavigate();\n  const userid = sessionStorage.getItem(\"user_id\");\n  const [unreadMessageCounts, setUnreadMessageCounts] = useState({});\n  useEffect(() => {\n    fetchChannels();\n    fetchUnreadMessageCounts();\n    const intervalId = setInterval(fetchUnreadMessageCounts, 1000);\n    return () => clearInterval(intervalId);\n  }, []);\n  const fetchChannels = async () => {\n    try {\n      const response = await fetch('http://127.0.0.1:5000/api/channels', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await response.json();\n      if (data.Success) {\n        setChannels(data.channels);\n      } else {\n        console.log('Display failed');\n      }\n    } catch (error) {\n      console.error('Error during display channels:', error);\n    }\n  };\n  const fetchUnreadMessageCounts = async () => {\n    try {\n      const response = await fetch(`http://127.0.0.1:5000/api/users/${userid}/unread_message_counts`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await response.json();\n      if (data.Success) {\n        const counts = data.unread_message_counts.reduce((acc, curr) => {\n          acc[curr.channel_id] = curr.unread_message_count;\n          return acc;\n        }, {});\n        console.log(\"counts: \", counts);\n        setUnreadMessageCounts(counts);\n      } else {\n        console.log('Failed to fetch unread message counts');\n      }\n    } catch (error) {\n      console.error('Error during fetching unread message counts:', error);\n    }\n  };\n  const handleChannelClick = channelId => {\n    navigate(`/channel/${channelId}`);\n    setCurrentChannelId(channelId);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"channel-list\",\n    children: channels.map(channel => /*#__PURE__*/_jsxDEV(\"div\", {\n      // Apply 'current-channel' class if this is the current channel\n      className: `channel ${currentChannelId === channel.id ? 'current-channel' : ''}`,\n      onClick: () => handleChannelClick(channel.id),\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"channel-name\",\n        children: channel.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }, this), unreadMessageCounts[channel.id] > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"unread-messages\",\n        children: [unreadMessageCounts[channel.id], \" unread\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }, this)]\n    }, channel.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n}\n_s(ChannelList, \"NKWVPE24Xo0zY9Q0jUwlhWJbqpY=\", false, function () {\n  return [useNavigate];\n});\n_c = ChannelList;\nexport default ChannelList;\nvar _c;\n$RefreshReg$(_c, \"ChannelList\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","jsxDEV","_jsxDEV","ChannelList","_s","channels","setChannels","currentChannelId","setCurrentChannelId","navigate","userid","sessionStorage","getItem","unreadMessageCounts","setUnreadMessageCounts","fetchChannels","fetchUnreadMessageCounts","intervalId","setInterval","clearInterval","response","fetch","method","headers","data","json","Success","console","log","error","counts","unread_message_counts","reduce","acc","curr","channel_id","unread_message_count","handleChannelClick","channelId","className","children","map","channel","id","onClick","name","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/wangchenhui/Desktop/final_project_belay/react/src/components/ChannelList.jsx"],"sourcesContent":["// ChannelList.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../styles/channelList.css';\n\nfunction ChannelList() {\n  const [channels, setChannels] = useState([]);\n  const [currentChannelId, setCurrentChannelId] = useState(null);\n  let navigate = useNavigate();\n  const userid = sessionStorage.getItem(\"user_id\");\n  const [unreadMessageCounts, setUnreadMessageCounts] = useState({});\n\n  useEffect(() => {\n    fetchChannels();\n    fetchUnreadMessageCounts();\n\n    const intervalId = setInterval(fetchUnreadMessageCounts, 1000);\n    return () => clearInterval(intervalId);\n  }, []);\n\n  const fetchChannels = async () => {\n    try {\n      const response = await fetch('http://127.0.0.1:5000/api/channels', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n      const data = await response.json();\n      if (data.Success) {\n        setChannels(data.channels);\n      } else {\n        console.log('Display failed');\n      }\n    } catch (error) {\n      console.error('Error during display channels:', error);\n    }\n  };\n\n  const fetchUnreadMessageCounts = async () => {\n    try {\n      const response = await fetch(`http://127.0.0.1:5000/api/users/${userid}/unread_message_counts`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n      const data = await response.json();\n      if (data.Success) {\n        const counts = data.unread_message_counts.reduce((acc, curr) => {\n          acc[curr.channel_id] = curr.unread_message_count;\n          return acc;\n        }, {});\n        console.log(\"counts: \", counts);\n        setUnreadMessageCounts(counts);\n      } else {\n        console.log('Failed to fetch unread message counts');\n      }\n    } catch (error) {\n      console.error('Error during fetching unread message counts:', error);\n    }\n  };\n\n  const handleChannelClick = (channelId) => {\n    navigate(`/channel/${channelId}`);\n    setCurrentChannelId(channelId);\n  };\n\n  return (\n    <div className=\"channel-list\">\n      {channels.map(channel => (\n        <div\n          key={channel.id}\n          // Apply 'current-channel' class if this is the current channel\n          className={`channel ${currentChannelId === channel.id ? 'current-channel' : ''}`} \n          onClick={() => handleChannelClick(channel.id)}\n        >\n          <span className=\"channel-name\">{channel.name}</span>\n          {/* <span className=\"unread-messages\">\n            {unreadMessageCounts[channel.id] ? ` ${unreadMessageCounts[channel.id]} unread` : ''}\n          </span> */}\n          {unreadMessageCounts[channel.id] > 0 && (\n            <span className=\"unread-messages\">\n              {unreadMessageCounts[channel.id]} unread\n            </span>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default ChannelList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}